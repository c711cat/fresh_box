"use strict";(self["webpackChunkfresh_box"]=self["webpackChunkfresh_box"]||[]).push([[248],{4248:function(e,t,a){a.r(t),a.d(t,{default:function(){return E}});var r=a(6768);function s(e,t,a,s,o,n){const i=(0,r.g2)("AdminNavbar"),c=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",null,[(0,r.bF)(i)]),(0,r.Lk)("div",null,[(0,r.bF)(c)])],64)}a(4114);var o=a(8704),n=a(4232),i=a(5130);const c=e=>((0,r.Qi)("data-v-4f1ca57f"),e=e(),(0,r.jt)(),e),d={class:"navbar navbar-expand-lg bg-light fixed-top"},l={class:"col-12 px-3 d-flex justify-content-between align-items-center flex-wrap"},h=c((()=>(0,r.Lk)("span",{class:"logoText text-center px-3 fs-3"},"FRESH BOX",-1))),u={ref:"adminMenu",class:"offcanvas offcanvas-end",id:"admin_offcanvasNavbar","aria-labelledby":"admin_offcanvasNavbarLabel","data-bs-backdrop":"true","data-bs-scroll":"true",tabindex:"-1"},p={class:"offcanvas-header px-4"},b={class:"offcanvas-body px-3"},f={class:"navbar-nav flex-grow-1"},m={class:"col-auto d-flex justify-conten-end align-items-center ms-auto"},g={class:"col-auto d-flex align-items-center searchContainer",role:"search"},v=["disabled"],k=c((()=>(0,r.Lk)("button",{type:"button",class:"d-none d-sm-block btn btn-outline-light bi bi-search fs-4 searchBtn border border-0"},null,-1))),x={class:"col-auto d-flex align-items-center",role:"search"},C={id:"mobile-admin",class:"mobileInputBox px-3 offcanvas offcanvas-top align-items-center justify-content-center"},S={key:0,class:"d-block d-sm-none w-100 mobileInputWrap"},L=["disabled"],O=c((()=>(0,r.Lk)("i",{class:"bi bi-search mobileSearchIcon"},null,-1))),T={key:1,class:"d-block d-sm-none w-100 mobileInputWrap"},P=c((()=>(0,r.Lk)("i",{class:"bi bi-search mobileSearchIcon"},null,-1))),I=c((()=>(0,r.Lk)("button",{type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#mobile-admin","aria-controls":"mobile-admin","aria-label":"Toggle mobile-admin",class:"d-block d-sm-none mobileSearchBtn btn bi bi-search fs-4 border border-0"},null,-1))),M=c((()=>(0,r.Lk)("button",{class:"navbar-toggler border-0",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#admin_offcanvasNavbar","aria-controls":"admin_offcanvasNavbar","aria-label":"Toggle navigation"},[(0,r.Lk)("i",{class:"bi bi-list fs-2 px-1"})],-1)));function y(e,t,a,s,o,c){const y=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("nav",d,[(0,r.Lk)("div",l,[(0,r.bF)(y,{to:"/",class:"navbar-brand text-center m-0"},{default:(0,r.k6)((()=>[h])),_:1}),(0,r.Lk)("div",u,[(0,r.Lk)("div",p,[(0,r.bF)(y,{onClick:t[0]||(t[0]=()=>c.closeMenu()),to:"/",class:"offcanvas-title logoText text-decoration-none fs-3 px-2",id:"offcanvasNavbarLabel"},{default:(0,r.k6)((()=>[(0,r.eW)(" FRESH BOX ")])),_:1}),(0,r.Lk)("button",{onClick:t[1]||(t[1]=()=>c.closeMenu()),type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})]),(0,r.Lk)("div",b,[(0,r.Lk)("ul",f,[(0,r.Lk)("li",{class:(0,n.C4)(["nav-item rounded",c.isMoileOrPc])},[(0,r.bF)(y,{onClick:t[2]||(t[2]=()=>c.closeMenu()),to:"/dashboard/admin-products",class:(0,n.C4)(["nav-link px-3 rounded",c.isCurrentPage("/dashboard/admin-products")])},{default:(0,r.k6)((()=>[(0,r.eW)(" 產品清單 ")])),_:1},8,["class"])],2),(0,r.Lk)("li",{class:(0,n.C4)(["nav-item rounded",c.isMoileOrPc])},[(0,r.bF)(y,{onClick:t[3]||(t[3]=()=>c.closeMenu()),to:"/dashboard/coupons",class:(0,n.C4)(["nav-link px-3 rounded",c.isCurrentPage("/dashboard/coupons")])},{default:(0,r.k6)((()=>[(0,r.eW)(" 優惠券 ")])),_:1},8,["class"])],2),(0,r.Lk)("li",{class:(0,n.C4)(["nav-item rounded",c.isMoileOrPc])},[(0,r.bF)(y,{onClick:t[4]||(t[4]=()=>c.closeMenu()),to:"/dashboard/order-list",class:(0,n.C4)(["nav-link px-3 rounded",c.isCurrentPage("/dashboard/order-list")])},{default:(0,r.k6)((()=>[(0,r.eW)(" 訂單 ")])),_:1},8,["class"])],2),(0,r.Lk)("li",{class:(0,n.C4)(["nav-item rounded",c.isMoileOrPc])},[(0,r.bF)(y,{onClick:t[5]||(t[5]=()=>c.closeMenu()),to:"/dashboard/admin-QA",class:(0,n.C4)(["nav-link px-3 rounded",c.isCurrentPage("/dashboard/admin-QA")])},{default:(0,r.k6)((()=>[(0,r.eW)(" 常見問題 ")])),_:1},8,["class"])],2),(0,r.Lk)("li",{class:(0,n.C4)(["nav-item rounded",c.isMoileOrPc])},[(0,r.Lk)("a",{onClick:t[6]||(t[6]=(0,i.D$)(((...e)=>c.logOut&&c.logOut(...e)),["prevent"])),class:"nav-link px-3",href:"#"}," 登出 ")],2)])])],512),(0,r.Lk)("div",m,[(0,r.Lk)("form",g,["/dashboard/order-list"===e.$route.path?(0,r.bo)(((0,r.uX)(),(0,r.CE)("input",{key:0,"onUpdate:modelValue":t[7]||(t[7]=e=>o.orderSearchText=e),disabled:c.disabledSearchInput,class:"d-none d-sm-block form-control searchInput",type:"search",placeholder:"搜尋訂單者姓名","aria-label":"Search"},null,8,v)),[[i.Jo,o.orderSearchText]]):(0,r.bo)(((0,r.uX)(),(0,r.CE)("input",{key:1,"onUpdate:modelValue":t[8]||(t[8]=e=>o.productSearchText=e),class:"d-none d-sm-block form-control searchInput",type:"search",placeholder:"搜尋產品名稱","aria-label":"Search"},null,512)),[[i.Jo,o.productSearchText]]),k]),(0,r.Lk)("form",x,[(0,r.Lk)("div",C,["/dashboard/order-list"===e.$route.path?((0,r.uX)(),(0,r.CE)("div",S,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>o.orderSearchText=e),disabled:c.disabledSearchInput,class:"form-control mobileInput",type:"search",placeholder:"搜尋訂單者姓名","aria-label":"Search"},null,8,L),[[i.Jo,o.orderSearchText]]),O])):((0,r.uX)(),(0,r.CE)("div",T,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>o.productSearchText=e),class:"form-control mobileInput",type:"search",placeholder:"搜尋產品名稱","aria-label":"Search"},null,512),[[i.Jo,o.productSearchText]]),P]))]),I]),M])])])}var $=a(8886),_=a.n($),R={data(){return{adminNavbar:{},productSearchText:"",orderSearchText:"",searchResult:[],products:[],orderPage:1,orders:[],pagination:{},orderSearchResult:[],currentWidth:1e3}},inject:["emitter"],watch:{productSearchText(){""===this.productSearchText?this.emitter.emit("adminSearchProductNull"):(Object.values(this.products).forEach((e=>{e.title.match(this.productSearchText)&&this.searchResult.push(e),this.emitter.emit("adminSearchProductResult",{data:this.searchResult,data2:this.productSearchText})})),this.searchResult=[])},orderSearchText(){this.orderSearchResult=[],""===this.orderSearchText?this.emitter.emit("adminOrderSearchNull"):(this.orders.forEach((e=>{e.user.name.match(this.orderSearchText)&&this.orderSearchResult.push(e)})),this.emitter.emit("adminOrderSearchResult",{data:this.orderSearchResult,...this.orderSearchText}),this.orderSearchResult=[])}},methods:{isCurrentPage(e){let t="";return this.$route.path===e&&this.currentWidth<992&&(t="isCurrentNavbarItem mobileBg"),this.$route.path===e&&this.currentWidth>=992&&(t="isCurrentNavbarItem"),t},closeMenu(){this.adminNavbar.hide()},logOut(){this.closeMenu();const e="https://vue3-course-api.hexschool.io/v2/logout";this.$http.post(e).then((()=>{this.$router.push("/login"),this.$pushMsg.status200("已登出")})).catch((e=>{this.$pushMsg.status404(e.response,"登出失敗")}))},getProducts(){const e="https://vue3-course-api.hexschool.io/v2/api/fresh_box-api/admin/products/all";this.isLoading=!0,this.$http.get(e).then((e=>{this.products=e.data.products})).catch((e=>{this.$pushMsg.status404(e.response,"取得產品資料失敗")})).finally((()=>{this.isLoading=!1}))},getOrdersOfPage1(){const e=`https://vue3-course-api.hexschool.io/v2/api/fresh_box-api/admin/orders?page=${this.orderPage}`;this.$http.get(e).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.fetchOrdersOfOtherPages(e.data.pagination.total_pages)})).catch((e=>{this.$pushMsg.status404(e.response,e.response.data.message)}))},fetchOrdersOfOtherPages(e){if(this.orderPage=this.orderPage+1,this.orderPage<=e){const t=`https://vue3-course-api.hexschool.io/v2/api/fresh_box-api/admin/orders?page=${this.orderPage}`;this.$http.get(t).then((t=>{this.pagination=t.data.pagination,this.orders=[...this.orders,...t.data.orders],this.fetchOrdersOfOtherPages(e)})).catch((e=>{this.$pushMsg.status404(e.response,"取得訂單資料失敗")}))}},isCurrentWidth(){this.currentWidth=window.innerWidth}},computed:{isMoileOrPc(){return this.currentWidth<992?"isMobileItem":""},disabledSearchInput(){return this.pagination.current_page!==this.pagination.total_pages}},created(){this.getOrdersOfPage1(),this.getProducts(),setTimeout((()=>{this.isCurrentWidth()}),500)},mounted(){this.adminNavbar=new(_())(this.$refs.adminMenu,{toggle:!1})}},w=a(1241);const W=(0,w.A)(R,[["render",y],["__scopeId","data-v-4f1ca57f"]]);var F=W,N={data(){return{}},components:{AdminNavbar:F},methods:{getToken(){const e=o.A.get("freshBoxToken");this.$http.defaults.headers.common.Authorization=e,this.checkSignIn()},checkSignIn(){const e="https://vue3-course-api.hexschool.io/v2/api/user/check";this.$http.post(e).then((()=>{})).catch((e=>{this.$pushMsg.status404(e.response,e.response.data.message),this.$router.push("/login")}))}},created(){this.getToken()}};const A=(0,w.A)(N,[["render",s]]);var E=A},8704:function(e,t,a){
/*! js-cookie v3.0.5 | MIT */
function r(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)e[r]=a[r]}return e}a.d(t,{A:function(){return n}});var s={read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function o(e,t){function a(a,s,o){if("undefined"!==typeof document){o=r({},t,o),"number"===typeof o.expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),a=encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var n="";for(var i in o)o[i]&&(n+="; "+i,!0!==o[i]&&(n+="="+o[i].split(";")[0]));return document.cookie=a+"="+e.write(s,a)+n}}function s(t){if("undefined"!==typeof document&&(!arguments.length||t)){for(var a=document.cookie?document.cookie.split("; "):[],r={},s=0;s<a.length;s++){var o=a[s].split("="),n=o.slice(1).join("=");try{var i=decodeURIComponent(o[0]);if(r[i]=e.read(n,i),t===i)break}catch(c){}}return t?r[t]:r}}return Object.create({set:a,get:s,remove:function(e,t){a(e,"",r({},t,{expires:-1}))},withAttributes:function(e){return o(this.converter,r({},this.attributes,e))},withConverter:function(e){return o(r({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var n=o(s,{path:"/"})}}]);
//# sourceMappingURL=248.af018aeb.js.map